% % Energielandschaft eine Butans
% 


function [ges_F, grad,F] = pot_butan(atom)

% Die Koodianten der Atome müssen als Zeilenvektor übergeben werden

% Wechelwirkungen von Butan
%     C1 H1 H2 H3 C2 H4 H5 C3 H6 H7 C4 H8 H9 H10
%  C1 00 12 12 12 13 22 22 23 32 32 33 42 42 42
%  H1 12 00 21 21 23 31 31 42 41 41 42 41 41 41
%  H2 12 21 00 21 23 31 31 42 41 41 42 41 41 41
%  H3 12 21 21 00 23 31 31 42 41 41 42 41 41 41
%  C2 13 23 23 23 00 12 12 13 22 22 23 32 32 32
%  H4 22 31 31 31 12 00 21 22 31 31 42 43 43 43
%  H5 22 31 31 31 12 21 00 22 31 31 42 43 43 43   
%  C3 23 42 42 42 13 22 22 00 12 12 13 22 22 22
%  H6 32 41 41 41 22 31 31 12 00 21 22 31 31 31
%  H7 32 41 41 41 22 31 31 12 21 00 22 31 31 31
%  C4 33 42 42 42 23 42 42 13 22 22 00 12 12 12
%  H8 42 41 41 41 32 43 43 22 31 31 12 00 21 21
%  H9 42 41 41 41 32 43 43 22 31 31 12 21 00 21
% H10 42 41 41 41 32 43 43 22 31 31 12 21 21 00     

WW = [00 12 12 12 13 22 22 23 32 32 33 42 42 42;
      12 00 21 21 23 31 31 42 41 41 42 41 41 41;
      12 21 00 21 23 31 31 42 41 41 42 41 41 41;
      12 21 21 00 23 31 31 42 41 41 42 41 41 41;
      13 23 23 23 00 12 12 13 22 22 23 32 32 32;
      22 31 31 31 12 00 21 22 31 31 42 43 43 43;
      22 31 31 31 12 21 00 22 31 31 42 43 43 43;   
      23 42 42 42 13 22 22 00 12 12 13 22 22 22;
      32 41 41 41 22 31 31 12 00 21 22 31 31 31;
      32 41 41 41 22 31 31 12 21 00 22 31 31 31;
      33 42 42 42 23 42 42 13 22 22 00 12 12 12;
      42 41 41 41 32 43 43 22 31 31 12 00 21 21;
      42 41 41 41 32 43 43 22 31 31 12 21 00 21;
      42 41 41 41 32 43 43 22 31 31 12 21 21 00];

atom = reshape(atom,3,14);
grad = zeros(3,14); 

[n,m]=size(atom);

F = zeros(n,m);

ges_F = 0; 
K=5;
T=5;
for i=1:m
    for j = i+1:m
        %[f,fx,fy,fz] = KraftButan_hom(K,T,atom(:,i),atom(:,j),WW(i,j),1);
        [f,fx,fy,fz] = KraftButan(K,T,atom(:,i),atom(:,j),WW(i,j));
        F(i,j) = f;
        ges_F = ges_F + f;
        
        grad(1,i) = grad(1,i) + fx;
        grad(2,i) = grad(2,i) + fy;
        grad(3,i) = grad(3,i) + fz;
        
        grad(1,j) = grad(1,j) - fx;
        grad(2,j) = grad(2,j) - fy;
        grad(3,j) = grad(3,j) - fz;
    end
end

grad =  grad(:);
%ges_F = ges_F/2;

% ges_F2 = 0; 
% grad2 = zeros(3,14);
% 
% for i=1:m
%     for j = 1:m
%         %[f,fx,fy,fz] = KraftButan_hom(K,T,atom(:,i),atom(:,j),WW(i,j),0);
%         [f,fx,fy,fz] = KraftButan(K,T,atom(:,i),atom(:,j),WW(i,j));
%         F(i,j) = f;
%         ges_F2 = ges_F2 + f;
%         
%         grad2(1,i) = grad2(1,i) + fx;
%         grad2(2,i) = grad2(2,i) + fy;
%         grad2(3,i) = grad2(3,i) + fz;
%         
%     end
% end
% 
% grad2 =  grad2(:);
% ges_F2 = ges_F2/2;



% for j=i:m
%      grad(1,j) = grad(1,j) - fx;
%         grad(2,j) = grad(2,j) - fy;
%         grad(3,j) = grad(3,j) - fz;
% end
% % Unterschidelichen Verbindungen 
% %      H H H H
% %      | | | |
% %    H-C-C-C-C-H
% %      | | | |
% %      H H H H
% 
% %      4 7 9  12
% %      | | |  |
% %    2-1-5-8- 11-13
% %      | | |  |
% %      3 6 10 14
% 
% % Tabellarische Zusammenfassung der unterscheidlichen Potentialle
% 
% %     C1 H1 H2 H3 C2 H4 H5 C3 H6 H7 C4 H8 H9 H10
% %  C1 -  BW BW BW BW B! B! B! TL TL TL LJ LJ LJ
% %  H1     - B! B! B! TL TL TL LJ LJ LJ LJ LJ LJ
% %  H2        - B! B! TL TL TL LJ LJ LJ LJ LJ LJ
% %  H3           - B! TL TL TL LJ LJ LJ LJ LJ LJ
% %  C2              - BW BW BW B! B! B! TL TL TL
% %  H4                 - B! B! TL TL TL LJ LJ LJ
% %  H5                    - B! TL TL TL LJ LJ LJ   
% %  C3                       - BW BW BW B! B! B!
% %  H6                          - B! B! TL TL TL
% %  H7                             - B! TL TL TL
% %  C4                                - BW BW BW
% %  H8                                   - B! B!
% %  H9                                      - B!
% %  H10                                        -
% 
% 
% % Potential
%       % Bindung Winkel CC
% % f = +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54)^2)^2 
% 
%     % Bindung Winkel CH
% % f = +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06)^2)^2 
% 
% %     Bindung Winkel 1-3 C C
% %     dCC = 1.54^2+1.54^2-2*1.54^2*cos(109.5*(2*pi/360))
% %     +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.54^2-2*1.54^2*cos(109.5*(2*pi/360))))^2
% %     Bindung Winkel 1-3 C H
% %     dCH = 1.54^2+1.06^2-2*1.54*1.06*cos(109.5*(2*pi/360))
% %     +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2
% %     Bindung Winkel 1-3 H H
% %     dHH = 1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))
% %     +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))))^2
% 
% %     % Lennard Jones CC
% %     +0.01*(285800/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 -372.5/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)  
% %     % Lennard Jones CH
% %     +0.01*(37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)   
% %     % Lennard Jones HH
% %     +0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)   
% 
% %     % Torsions 
% %     d1CC = d60
% %     d1CC=(1.54^2+2*1.54^2*cos(109.5*(2*pi/360))*cos(109.5*(2*pi/360))-1/2*sin(109.5*(2*pi/360))*sin(109.5*(2*pi/360))+1.54^2-2*1.54^2*cos(109.5*(2*pi/360)));
% %     d2 CC = d180
% %     d2CC=1.54^2+2*1.54^2+1.54^2-2*1.54^2*cos(109.5*(2*pi/360));
% %     d1HH = d60
% %     d1HH=(1.06^2+2*(1.54*1.06)*cos(109.5*(2*pi/360))*cos(109.5*(2*pi/360))-1/2*sin(109.5*(2*pi/360))*sin(109.5*(2*pi/360))+1.06^2-2*(1.54*1.06)*cos(109.5*(2*pi/360)));
% %     d2HH = d180
% %     d2HH=1.06^2+2*(1.54*1.06) + 1.06^2 - 2*(1.54+1.06)*cos(109.5*(2*pi/360));
% %     d1CH = d60
% %     d1CH = (1.06^2+ 2*1.54*1.06*cos(109.5*(2*pi/360))*cos(109.5*(2*pi/360))-1/2*sin(109.5*(2*pi/360))*sin(109.5*(2*pi/360))+1.54^2-2*(1.54*1.06)*cos(109.5*(2*pi/360)));
% %     d2CH = d180
% %     d2CH = 1.06^2+2*(1.54*1.06)+1.54^2-2*1.54*1.06*cos(109.5*(2*pi/360));
% %     + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH180)^2
% 
% 
% 
% % d/dx f = 4*(x-x0)*K(i,j)*((x-x0)^2+(y-y0)^2+(z-z0)^2 -a(i,j)^2) + ( 6*B(i,j)*(x-x0)/((x-x0)^2+(y-y0)^2+(z-z0)^2)^4 * ...
% %          - 12*A(i,j)*(x-x0)/((x-x0)^2+(y-y0)^2+(z-z0)^2)^7) + ...
% %          T(i,j)* 4*(x-x0) * ((x-x0)^2+(y-y0)^2+(z-z0)^2-d1(i,j)^2) ...
% %          *((x-x0)^2+(y-y0)^2+(z-z0)^2-d2(i,j)^2)^2 + ((x-x0)^2+(y-y0)^2+(z-z0)^2-d1(i,j)^2)^2 ...
% %          *((x-x0)^2+(y-y0)^2+(z-z0)^2-d2(i,j)^2);
% %
% %           d/dx0 = -1*d/dx
% %
% %      
% % d/dy f = 4*(y-y0)*K(i,j)*((x-x0)^2+(y-y0)^2+(z-z0)^2 -a(i,j)^2) + ( 6*B(i,j)*(y-y0)/((x-x0)^2+(y-y0)^2+(z-z0)^2)^4 * ...
% %          - 12*A(i,j)*(y-y0)/((x-x0)^2+(y-y0)^2+(z-z0)^2)^7) + ...
% %          T(i,j)* 4*(y-y0)*(((x-x0)^2+(y-y0)^2+(z-z0)^2)-d1(i,j)^2) ...
% %          *(((x-x0)^2+(y-y0)^2+(z-z0)^2)-d2(i,j)^2)^2 + (((x-x0)^2+(y-y0)^2+(z-z0)^2)-d1(i,j)^2)^2 ...
% %          *(((x-x0)^2+(y-y0)^2+(z-z0)^2)-d2(i,j)^2);
% %
% %           d/dy0 = -1*d/dy
% %
% %      
% % d/dz f = 4*(z-z0)*K(i,j)*(((x-x0)^2+(y-y0)^2+(z-z0)^2) -a(i,j)^2) + ( 6*B(i,j)*(z-z0)/((x-x0)^2+(y-y0)^2+(z-z0)^2)^4 * ...
% %          - 12*A(i,j)*(z-z0)/((x-x0)^2+(y-y0)^2+(z-z0)^2)^7) + ...
% %          T(i,j)* 4*(z-z0)*(((x-x0)^2+(y-y0)^2+(z-z0)^2)-d1(i,j)^2) ...
% %          *(((x-x0)^2+(y-y0)^2+(z-z0)^2)-d2(i,j)^2)^2 + (((x-x0)^2+(y-y0)^2+(z-z0)^2)-d1(i,j)^2)^2 ...
% %          *(((x-x0)^2+(y-y0)^2+(z-z0)^2)-d2(i,j)^2);
% %
% %           d/dz0 = -1*d/dz
% %
% 
% 
% dCC60  = (1.54^2+2*1.54^2*cos(109.5*(2*pi/360))*cos(109.5*(2*pi/360))-1/2*sin(109.5*(2*pi/360))*sin(109.5*(2*pi/360))+1.54^2-2*1.54^2*cos(109.5*(2*pi/360)));
% dCC180 = 1.54^2+2*1.54^2+1.54^2-2*1.54^2*cos(109.5*(2*pi/360));
% dHH60  = (1.06^2+2*(1.54*1.06)*cos(109.5*(2*pi/360))*cos(109.5*(2*pi/360))-1/2*sin(109.5*(2*pi/360))*sin(109.5*(2*pi/360))+1.06^2-2*(1.54*1.06)*cos(109.5*(2*pi/360))); 
% dHH180 = 1.06^2+2*(1.54*1.06) + 1.06^2 - 2*(1.54+1.06)*cos(109.5*(2*pi/360));
% dCH60  = (1.06^2+ 2*1.54*1.06*cos(109.5*(2*pi/360))*cos(109.5*(2*pi/360))-1/2*sin(109.5*(2*pi/360))*sin(109.5*(2*pi/360))+1.54^2-2*(1.54*1.06)*cos(109.5*(2*pi/360)));
% dCH180 = 1.06^2+2*(1.54*1.06)+1.54^2-2*1.54*1.06*cos(109.5*(2*pi/360));
% % Kraftfeld
% i=1; j=1;
% % C1 7BW (2C 5H ) 3 LJ 3TL
% % C1 H1 
% f= K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06)^2)^2 ...
% % C1 H2
% + K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06)^2)^2 ...
% % C1 H3
% + K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06)^2)^2 ...
% % C1 C2
% + K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54)^2)^2 ...
% % C1 H4
% + K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % C1 H5
% + K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % C1 C3
% + K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.54^2-2*1.54^2*cos(109.5*(2*pi/360))))^2 ...
% % C1 H6 
% + 0.01*(37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH180)^2 ...
% % C1 H7
% + 0.01*(37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH180)^2 ...
% % C1 C4 
% + 0.01*(285800/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 -372.5/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)  + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCC60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCC180)^2 ...
% % C1 H8
% + (37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)...
% % C1 H9
% + (37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) ...
% % C1 H10
% + (37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) ...
% % H1 H2
% + K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))))^2 ...
% % H1 H3
% + K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))))^2  ...
% % H1 C2 
% + K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.54^2-2*1.54^2*cos(109.5*(2*pi/360))))^2 ...
% % H1 H4
% + 0.01*(37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2 ...
% % H1 H5
% + 0.01*(37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2 ...
% % H1 C3
% + 0.01*(37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH180)^2 ...
% % H1 H6
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) ...
% %H1 H7
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)   ...
% %H1 C4
% + (37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) ...
% % H1 H8
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)...   
% % H1 H9
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)   ...
% % H1 H10
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)  ...
% % H2 H3
% + K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))))^2 ...
% % H2 C2
% + K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % H2 H4
% + 0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2 ...
% % H2 H5
% + 0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2 ...
% % H2 C3
% + 0.01*(37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH180)^2 ...
% % H2 H6 
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) ...
% % H2 H7
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) ...
% %H2 C4
% + (37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)   ...
% % H2 H8
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)   ...
% % H2 H9
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)   ...
% % H2 H10
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)   ...
% % H3 C2
% + K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % H3 H4 
% + 0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2 ...
% % H3 H5
% + 0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2 ...
% % H3 C3
% + 0.01*(37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)+ T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH180)^2 ...
% % H3 H6
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) ...  
% % H3 H7 
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)...
% % H3 C4 
% + (37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)   
% % H3 H8 
% +(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)   ...
% % H3 H9 
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)   ...
% % H3 H10
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)   ...
% % C2 H4
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06)^2)^2 ...
% % C2 H5
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06)^2)^2 ...
% % C2 C3
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54)^2)^2 ...
% % C2 H6
%  +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % C2 H7
%  +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % C2 C4
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.54^2-2*1.54^2*cos(109.5*(2*pi/360))))^2 ...
% % C2 H8
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))))^2 + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH180)^2 ...
% % C2 H9
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))))^2 + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH180)^2 ...
% % C2 H10
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))))^2 + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH180)^2 ...
% % H4 H5
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))))^2 ...
% % H4 C3
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % H4 H6 
% +0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2 ... 
% % H4 H7
% +0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2 ... 
% % H4 C4
% +0.01*(37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)+ T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH180)^2 ...   
% % H4 H8
% +(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) ...   
% % H4 H9
% +(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)    ...
% % H4 H10
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)    ...
% % H5 C3
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % H5 H6 
% +0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2 ... 
% % H5 H7
% +0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2 ... 
% % H5 C4
% +0.01*(37430/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 127.4/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)+ T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dCH180)^2 ...   
% % H5 H8
% +(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) ...   
% % H5 H9
% +(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)    ...
% % H5 H10
% + (7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3)    ...
% % C3 H6
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06)^2)^2 ...
% % C3 H7 
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06)^2)^2 ...
% % C3 C4 
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54)^2)^2 ...
% % C3 H8 
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % C3 H9 
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % C3 H10
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % H6 H7
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))))^2 ...
% % H6 C4 
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % H6 H8 
% +0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2 ...  
% % H6 H9 
% +0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2  ...
% % H6 H10
% +0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2  ...
% % H7 C4 
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.54^2+1.06^2-2*1.06^2*cos(109.5*(2*pi/360))))^2 ...
% % H7 H8 
% +0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2  ...
% % H7 H9 
% +0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2  ...
% % H7 H10
% +0.01*(7220/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^6 - 76/((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)^3) + T*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH60)^2*(((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2)-dHH180)^2  ...
% % C4 H8
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06)^2)^2 ...
% % C4 H9
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06)^2)^2  ...
% % C4 H10
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06)^2)^2  ...
% % H8 H9
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))))^2 ...
% % H8 H10
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))))^2 ...
% % H9 H10
% +K*((x(i)-x(j))^2+(y(i)-y(j))^2+(z(i)-z(j))^2 -(1.06^2+1.06^2-2*1.06*1.06*cos(109.5*(2*pi/360))))^2;