% % Energielandschaft eine Butans
% 


function [ges_F, grad,F] = pot_butan_hom(atom,par)

% Die Koodianten der Atome müssen als Zeilenvektor übergeben werden

% Wechelwirkungen von Butan
%     C1 H1 H2 H3 C2 H4 H5 C3 H6 H7 C4 H8 H9 H10
%  C1 00 12 12 12 13 22 22 23 32 32 33 42 42 42
%  H1 12 00 21 21 23 31 31 42 41 41 42 41 41 41
%  H2 12 21 00 21 23 31 31 42 41 41 42 41 41 41
%  H3 12 21 21 00 23 31 31 42 41 41 42 41 41 41
%  C2 13 23 23 23 00 12 12 13 22 22 23 32 32 32
%  H4 22 31 31 31 12 00 21 22 31 31 42 43 43 43
%  H5 22 31 31 31 12 21 00 22 31 31 42 43 43 43   
%  C3 23 42 42 42 13 22 22 00 12 12 13 22 22 22
%  H6 32 41 41 41 22 31 31 12 00 21 22 31 31 31
%  H7 32 41 41 41 22 31 31 12 21 00 22 31 31 31
%  C4 33 42 42 42 23 42 42 13 22 22 00 12 12 12
%  H8 42 41 41 41 32 43 43 22 31 31 12 00 21 21
%  H9 42 41 41 41 32 43 43 22 31 31 12 21 00 21
% H10 42 41 41 41 32 43 43 22 31 31 12 21 21 00     

WW = [00 12 12 12 13 22 22 23 32 32 33 42 42 42;
      12 00 21 21 23 31 31 42 41 41 42 41 41 41;
      12 21 00 21 23 31 31 42 41 41 42 41 41 41;
      12 21 21 00 23 31 31 42 41 41 42 41 41 41;
      13 23 23 23 00 12 12 13 22 22 23 32 32 32;
      22 31 31 31 12 00 21 22 31 31 42 43 43 43;
      22 31 31 31 12 21 00 22 31 31 42 43 43 43;   
      23 42 42 42 13 22 22 00 12 12 13 22 22 22;
      32 41 41 41 22 31 31 12 00 21 22 31 31 31;
      32 41 41 41 22 31 31 12 21 00 22 31 31 31;
      33 42 42 42 23 42 42 13 22 22 00 12 12 12;
      42 41 41 41 32 43 43 22 31 31 12 00 21 21;
      42 41 41 41 32 43 43 22 31 31 12 21 00 21;
      42 41 41 41 32 43 43 22 31 31 12 21 21 00];

atom = reshape(atom,3,14);
grad = zeros(3,14); 

[n,m]=size(atom);

F = zeros(n,m);

ges_F = 0; 
K=5;
T=5;
for i=1:m
    for j = 1:m
        [f,fx,fy,fz] = KraftButan_hom(K,T,atom(:,i),atom(:,j),WW(i,j),par);
        F(i,j) = f;
        ges_F = ges_F + f;
        
        grad(1,i) = grad(1,i) + fx;
        grad(2,i) = grad(2,i) + fy;
        grad(3,i) = grad(3,i) + fz;
    end
end

grad =  grad(:);
ges_F = ges_F/2;