%Skipt zur Simulation mit Homotopieclear Xem%close all% %Rangex=linspace(-0.5,1.5);%e.g. poth =@(y) 8.*y.^4-44/3.*y.^3 + 2.*y.^2 +11/3.*y+1;dpoth =@(y) 32.*y.^3-44.*y.^2+4.*y+11/3;pot = poth(x);dpot= dpoth(x);%t=0:0.1:1;%t=0.16:-.02:0.0;t=0.0:.01:0.16;%t=0.08:-.001:0.02;%t=0:0.04:0.16;%homopot = homopoth(x);epsilon = 0.6;% a = 0.5;% b =-0.5;% Xzero=1;a = 1.1;b = 1.2;N=1000; Xzero=-0.25; dt=1/1000;dW=sqrt(dt)*randn(1,N);%Xem = zeros(1,N);hitting_time=zeros(1,length(t));hitting_time_prob=zeros(1,length(t));hitting_time_prob2=zeros(1,length(t));hitting_time_prob3=zeros(1,length(t));S=1000; % Number of Simulations% matrix for saving the trajectoriesXtemp=zeros(S,N);Xtime=zeros(length(t),S);num=zeros(length(t),1000);ra = randn(S,N);    for i=1:length(t)    %homopoth =@(y) poth(y)+96.*t(i).^2+(4-88.*y+96.*y.^2).*t(i);        dhomopoth =@(y) dpoth(y)+(-88 +192.*y).*t(i);             Xtemp(:,1)=Xzero;              %j=1;        for j=1:N            Xtemp(:,j+1) = Xtemp(:,j) -(dhomopoth(Xtemp(:,j))).*dt + sqrt(dt).*epsilon.*ra(:,j);        end        Xhelp=(Xtemp>=.5);        for k=1:S            if sum(Xhelp(k,:))>1                Xtime(i,k)=find(Xhelp(k,:),1,'first');            else                Xtime(i,k)=N;            end        end    endXtime=Xtime*dt;mtimes=Xtime*ones(S,1)./S;rates=1./mtimes;hr=5:17;th=t(hr);hrates=rates(hr);p=polyfit(th',hrates,1);mrate=zeros(length(t),1);cc=zeros(length(t),1);sigma=zeros(length(t),1);for i=1:length(t)    mrate(i) = mean(Xtime(i,:));    sigma(i)= sum((Xtime(i,:)-mrate(i)).^2);    cc(length(t)+1-i) = 1.96*sqrt(sigma(i)/S);end%pfit=p(1).*t.^4+p(2).*t.^3+p(3).*t+p(4);%pfit=p(1).*t.^2+p(2).*t+p(3);l=linspace(0,0.16);pfit=p(1).*t+p(2);I=[ones(1,length(hr)); th.^2 ;th.^4]';ex=I\rates(hr);fit=ex(3).*l.^4+ex(2).*l.^2+ex(1);figure(3)plot(l,fit,'Linewidth',2)hold onplot(t(hr),1./mtimes(hr),'.-r','Linewidt',2)%plot(t,1./ext,'g','Linewidth',2)hold offlegend('extr. rate','samp. rate','Location','NorthWest')xlabel('Lambda')ylabel('Exit rate for x=-.25')% figure(1)% plot(t,pfit,'g');figure(1)errorbar(t(hr),rates(hr),cc(hr),'r.','Linewidth',2)xlabel('Lambda')ylabel('Variance of the estimator')%%    figure(1) hold all %for k=1:10:length(t) for k=1:length(t)     %t(k) plot(num(k,:),'LineWidth',4)  xlabel('time') ylabel('Number of Processes in Well') %title('Prob Exit Rate') end hold off l= legend('$\lambda = 0.08 $','$\lambda = 0.07 $','$\lambda = 0.06 $','$\lambda = 0.05 $','$\lambda = 0.04 $','$\lambda = 0.03 $','$\lambda = 0.02 $','Location','southwest');%l= legend('$\lambda = 0 $','$\lambda = 0.4 $','$\lambda = 0.08 $','$\lambda = 0.12 $','$\lambda = 0.16 $','Location','southwest');set(l,'Interpreter','Latex');% lgened('')    figure(2) %hold on for k=1:length(t) semilogy(num(k,:)/1000) hold all xlabel('time') ylabel('Number of Processes in Well') title('Prob Exit Rate') end  %hold off   rate=zeros(1,length(t)); for l=1:length(t)          pos_help=find(num(l,:)> 0,1,'last');     time=(1:pos_help);     prob=log(num(l,1:pos_help)/1000);     p=polyfit(time,prob,1);     rate(l)=p(1);   end  figure(3) semilogy(t,-rate,'o--')  figure(6) plot(t,-rate)  pos_help=find(-rate>0,1,'last'); rate_help=log(-rate(1:pos_help));   p1=polyfit(t(1:pos_help),rate_help,1); p4=polyfit(t(1:pos_help),rate_help,4); %  figure(4)%  yfit1 = p1(1).*t+p1(2);%  plot(t,yfit1) yfit4 =p4(1).*t.^4+ p4(2).*t.^3+ p4(3).*t.^2+p4(4).*t+p4(5); figure(4) plot(t,yfit4); hold all plot(t,log(-rate)); hold off %semilogy(t,yfit4); figure(5) semilogy(t,yfit4)  % extrapolation ohne auasreiÃŸer  pos_help=find(t>0.038,1,'last'); rate_help=log(-rate(1:pos_help));  p4=polyfit(t(1:pos_help),rate_help,4);  t_help=linspace(0,0.08);  yfit4 =p4(1).*t_help.^4+ p4(2).*t_help.^3+ p4(3).*t_help.^2+p4(4).*t_help+p4(5);  figure(7) plot(t_help,yfit4,'LineWidth',4); hold all plot(t(1:5:pos_help),log(-rate(1:5:pos_help)),'o','LineWidth',4); hold off xlabel('Homotopy Parameter') ylabel('log(Rates)') legend('Extrapolated Rates','Real Rates','Location','southeast')   t=[0,0.04,0.08,0.12,0.16]; homopoth =@(y,h) poth(y)+96.*h.^2+(4-88.*y+96.*y.^2).*h; figure(8)   for i=1:5     V = homopoth(x,t(i));     plot(x,V,'LineWidth',4)     hold all end xlabel('position space') ylabel('potential energy') hold off ylim([-0.5 17 ])l=legend('$\lambda = 0 $','$\lambda = 0.04 $','$\lambda = 0.08 $','$\lambda = 0.12 $','$\lambda = 0.16 $','Location','northwest'); set(l,'Interpreter','Latex');  t=[0,0.04,0.08,0.12,0.16]; homopoth =@(y,h) poth(y)+96.*h.^2+(4-88.*y+96.*y.^2).*h; figure(9) for i=1:5     V = homopoth(x,t(i));     B = exp(-1 *V);     plot(x,B,'LineWidth',4)     hold all end xlabel('position space') ylabel('Boltzman distribution') hold offl=legend('$\lambda = 0 $','$\lambda = 0.04 $','$\lambda = 0.08 $','$\lambda = 0.12 $','$\lambda = 0.16 $','Location','northwest');set(l,'Interpreter','Latex');  